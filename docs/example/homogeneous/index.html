<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://mdesignlab.github.io/fonts/vendor/static/STIXTwoText-Regular.ttf type=font/ttf crossorigin><link rel=preload as=font href=https://mdesignlab.github.io/fonts/KaTeX_Main-Regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://mdesignlab.github.io/fonts/KaTeX_Math-Italic.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(e){/^global-alert-/.test(e)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://mdesignlab.github.io/main.48c64f1d38d68c12a3cd992c4548b59e02da9c336b012dfa73e25601d58fcf783f4d7242b3fa80abd49e9a4bc9c00fe6fb77a4a310cab1f4b0a9f9428d418ad2.css integrity="sha512-SMZPHTjWjBKjzZksRUi1ngLanDNrAS36c+JWAdWPz3g/TXJCs/qAq9SemkvJwA/m+3ekoxDKsfSwqflCjUGK0g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel=stylesheet><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Small Molecule in Water - DFT-CES</title><meta name=description content="Doks is a Hugo theme for building secure, fast, and SEO-ready documentation websites, which you can easily update and customize."><link rel=canonical href=https://mdesignlab.github.io/docs/example/homogeneous/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Small Molecule in Water"><meta property="og:description" content="Doks is a Hugo theme for building secure, fast, and SEO-ready documentation websites, which you can easily update and customize."><meta property="og:url" content="https://mdesignlab.github.io/docs/example/homogeneous/"><meta property="og:site_name" content="DFT-CES"><meta property="article:published_time" content="2021-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2021-10-06T08:48:57+00:00"><meta property="og:image" content="https://mdesignlab.github.io/m_design_logo.png"><meta property="og:image:alt" content="DFT-CES"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="Small Molecule in Water"><meta name=twitter:description content="Doks is a Hugo theme for building secure, fast, and SEO-ready documentation websites, which you can easily update and customize."><meta name=twitter:image content="https://mdesignlab.github.io/m_design_logo.png"><meta name=twitter:image:alt content="Small Molecule in Water"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://mdesignlab.github.io/#/schema/organization/1","name":"Doks","url":"https://mdesignlab.github.io/","sameAs":["https://github.com/dft-ces/dft-ces2"],"logo":{"@type":"ImageObject","@id":"https://mdesignlab.github.io/#/schema/image/1","url":"https://mdesignlab.github.io/m_design_logo.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://mdesignlab.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://mdesignlab.github.io/#/schema/website/1","url":"https://mdesignlab.github.io/","name":"DFT-CES","description":"which stands for Density Functional Theory in Classical Explicit Solvents","publisher":{"@id":"https://mdesignlab.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://mdesignlab.github.io/docs/example/homogeneous/","url":"https://mdesignlab.github.io/docs/example/homogeneous/","name":"Small Molecule in Water","description":"Doks is a Hugo theme for building secure, fast, and SEO-ready documentation websites, which you can easily update and customize.","isPartOf":{"@id":"https://mdesignlab.github.io/#/schema/website/1"},"about":{"@id":"https://mdesignlab.github.io/#/schema/organization/1"},"datePublished":"2021-10-06T08:48:57CET","dateModified":"2021-10-06T08:48:57CET","breadcrumb":{"@id":"https://mdesignlab.github.io/docs/example/homogeneous/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://mdesignlab.github.io/docs/example/homogeneous/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://mdesignlab.github.io/docs/example/homogeneous/"]}]},{"@type":"BreadcrumbList","@id":"https://mdesignlab.github.io/docs/example/homogeneous/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://mdesignlab.github.io/","url":"https://mdesignlab.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://mdesignlab.github.io/docs/","url":"https://mdesignlab.github.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://mdesignlab.github.io/docs/example/","url":"https://mdesignlab.github.io/docs/example/","name":"Example"}},{"@type":"ListItem","position":4,"item":{"@id":"https://mdesignlab.github.io/docs/example/homogeneous/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://mdesignlab.github.io/#/schema/article/1","headline":"Small Molecule in Water","description":"Doks is a Hugo theme for building secure, fast, and SEO-ready documentation websites, which you can easily update and customize.","isPartOf":{"@id":"https://mdesignlab.github.io/docs/example/homogeneous/"},"mainEntityOfPage":{"@id":"https://mdesignlab.github.io/docs/example/homogeneous/"},"datePublished":"2021-10-06T08:48:57CET","dateModified":"2021-10-06T08:48:57CET","author":{"@id":"https://mdesignlab.github.io/#/schema/person/2"},"publisher":{"@id":"https://mdesignlab.github.io/#/schema/organization/1"},"image":{"@id":"https://mdesignlab.github.io/docs/example/homogeneous/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://mdesignlab.github.io/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/dft-ces"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://mdesignlab.github.io/docs/example/homogeneous/#/schema/image/2","url":"https://mdesignlab.github.io/m_design_logo.png","contentUrl":"https://mdesignlab.github.io/m_design_logo.png","caption":"Small Molecule in Water"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://mdesignlab.github.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://mdesignlab.github.io/icon-180x180.png><link rel=icon type=image/png sizes=32x32 href=https://mdesignlab.github.io/icon-32x32.png><link rel=manifest crossorigin=use-credentials href=https://mdesignlab.github.io/site.webmanifest></head><body class="docs single" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -90%" data-bs-smooth-scroll=true tabindex=0><div id=announcement data-id=global-alert-1583cb1298548006ae93874d7faa9dce class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>New generation of our DFT-CES method has been released! <a class="alert-link stretched-link" href=https://github.com/dft-ces/dft-ces2/>Check it out</a>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class=navbar-brand href=https://mdesignlab.github.io/><img src=icon.svg width=12% height=12%></a>
<button class="btn btn-link order-0 ms-auto d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasExample aria-controls=offcanvasExample><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasExample aria-labelledby=offcanvasExampleLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasExampleLabel>Browse docs</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-e8501da981ee0c09b948fb28b0847189 aria-expanded=false>
First Step</button><div class=collapse id=section-e8501da981ee0c09b948fb28b0847189><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/installation/>Installation</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/quick-start/>Quick Start</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/commands/>Commands</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0a52730597fb4ffa01fc117d9e71e3a9 aria-expanded=true>
Example</button><div class="collapse show" id=section-0a52730597fb4ffa01fc117d9e71e3a9><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=https://mdesignlab.github.io/docs/example/homogeneous/>Small Molecule in Water</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/example/heterogeneous/>Slab System</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-6a26f548831e6a8c26bfbbd9f6ec61e0 aria-expanded=false>
Help</button><div class=collapse id=section-6a26f548831e6a8c26bfbbd9f6ec61e0><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/how-to-update/>How to Update</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/troubleshooting/>Troubleshooting</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/faq/>FAQ</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://mdesignlab.github.io/>DFT-CES</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://mdesignlab.github.io/features/>Features</a></li><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://mdesignlab.github.io/docs/first-step/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://mdesignlab.github.io/download/>Download</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community</a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://mdesignlab.github.io/docs/help/faq/>FAQ</a></li><li><a class=dropdown-item href=https://github.com/dft-ces/dft-ces2/>GitHub</a></li><li><a class=dropdown-item href=https://groups.google.com/u/2/g/dft-ces-forum/>DFT-CES Forum</a></li></ul></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://mdesignlab.github.io/about-us/>About us</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-e8501da981ee0c09b948fb28b0847189 aria-expanded=false>
First Step</button><div class=collapse id=section-e8501da981ee0c09b948fb28b0847189><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/installation/>Installation</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/quick-start/>Quick Start</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/commands/>Commands</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0a52730597fb4ffa01fc117d9e71e3a9 aria-expanded=true>
Example</button><div class="collapse show" id=section-0a52730597fb4ffa01fc117d9e71e3a9><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=https://mdesignlab.github.io/docs/example/homogeneous/>Small Molecule in Water</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/example/heterogeneous/>Slab System</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-6a26f548831e6a8c26bfbbd9f6ec61e0 aria-expanded=false>
Help</button><div class=collapse id=section-6a26f548831e6a8c26bfbbd9f6ec61e0><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/how-to-update/>How to Update</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/troubleshooting/>Troubleshooting</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/faq/>FAQ</a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-e8501da981ee0c09b948fb28b0847189 aria-expanded=false>
First Step</button><div class=collapse id=section-e8501da981ee0c09b948fb28b0847189><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/installation/>Installation</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/quick-start/>Quick Start</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/first-step/commands/>Commands</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0a52730597fb4ffa01fc117d9e71e3a9 aria-expanded=true>
Example</button><div class="collapse show" id=section-0a52730597fb4ffa01fc117d9e71e3a9><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=https://mdesignlab.github.io/docs/example/homogeneous/>Small Molecule in Water</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/example/heterogeneous/>Slab System</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-6a26f548831e6a8c26bfbbd9f6ec61e0 aria-expanded=false>
Help</button><div class=collapse id=section-6a26f548831e6a8c26bfbbd9f6ec61e0><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/how-to-update/>How to Update</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/troubleshooting/>Troubleshooting</a></li><li><a class="docs-link rounded" href=https://mdesignlab.github.io/docs/help/faq/>FAQ</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"></nav><main class="docs-content col-lg-11 col-xl-9"><nav class=d-xl-none aria-label="Quaternary navigation"></nav><h1>Small Molecule in Water</h1><div class="callout callout-info">Example, a homogenous aqueous system</div><br><p><a href=http://www.samplchallenges.org/>SAMPL0</a> molecules have been chosen for a benchmark set to challenge and test how accurately our model predicts several properties of small molecules regarding the drug discovery.</p><p>One of the small molcules in the SAMPL0 set will be tested here to get started with DFT-CES.</p><h2>Get Started</h2>A system consists of one benzyl bromide molecule and 1000 water molecules. The benzyl bromide will be treated at quantum mechanics (QM) level, while the water molecules will be treated at the molecular mechanics (MM) level, described by the [TIP4P](https://doi.org/10.1063/1.1683075) model.<div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">👉</div><div class=w-100>Check out the details of TIP4P water model.</div></div><h3>Construction of Systems</h3><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">💡</div><div class=w-100>The information for QM/MM coupling is mediated by the real-space grid.</div></div><p>It is important to note that in our real-space grid-based approach, the exchange of inforamtion about interactions across the systems occurs through the grid. Therefore, it is necessary to first construct the grid.</p><p>The grid will cover the whole QM/MM system, and its grid size is determined based on the QM system, taking into account the desired level of accuracy. Considering the memory allocation requirements, it is generally recommended to have a grid size of around 0.15 angstrom along x-, y-, and z-coordinate. When performing DFT calculations, the default number of grid points (nr1, nr2, nr3) is typically sufficient, based on the <a href=https://www.quantum-espresso.org/Doc/INPUT_PW.html#idm313/>ecutrho</a> criterion.</p><p>In a homogeneous system, it is important to consider the potential overlap between the QM and MM regions and the possibility of change in the density afterwards. Taking these factors into account, you can utilize the OPLS force field to predict the density and adjust the grid size accordingly.</p><p>To proceed with the QM/MM system construction, you can follow these steps:</p><ol><li><p>Define the QM and MM regions: Identify the specific atoms or molecular fragments that will be treated quantum mechanically (QM) and those that will be treated using the OPLS force field (MM). It is crucial to ensure that there is no overlap between the QM and MM regions.</p></li><li><p>Predict the density using the OPLS force field: Apply the OPLS force field to the MM region to obtain a density. This density prediction will serve as a basis for subsequent QM calculations.</p></li><li><p>Adjust the grid size: Since the QM calculations will be performed on a real-space grid, the grid size should be adjusted accordingly. Consider the level of accuracy required and ensure that the grid is fine enough to capture the relevant electronic properties of the QM region.</p></li><li><p>Deform the system box: On a given condition, <code>deform</code> the box to obtain a cell with the structure which is presumably acceptable.</p></li><li><p>Perform QM calculations: Use an appropriate quantum mechanical method (e.g., DFT) to perform calculations on the QM region. The QM/MM interface will allow for the exchange of information between the QM and MM regions.</p></li></ol><p>By following these steps, you can construct a QM/MM system for a homogeneous system, taking into account the potential overlap between regions and adjusting the grid size based on the density prediction obtained from the OPLS force field.</p><div class="alert alert-doks d-flex" role=alert><div class="flex-shrink-1 alert-icon">💡</div><div class=w-100>Here, the OPLS force field is used to predict the density at a glance. You can use some other force fields and then modify later on according to the result of QM/MM.</div></div><details><summary>How to partition the system?</summary>
In DFT-CES, each region of the QM/MM system is not spatially partitioned. Instead, when it is necessary to analyze the electronic structure or when bond interactions are of primary importance, specific atoms are designated for QM calculations, while the remaining atoms are treated under the molecular mechanics (MM) representation.</details><h2>Go Further</h2><h3>Generation of Cube Files</h3><p>Extract the information for coupling the QM/MM systems. First of all, obtain the cube file of electrostatic potential with 6 float numbers in a row.</p><p>The <code>plot_num = 11</code> will give you the bare potential and hartree potential as described in <a href=https://www.quantum-espresso.org/Doc/INPUT_PP.html>pp.x</a> of Quantum ESPRESSO. And, plot another cube with <code>plot_num = 0</code> for the valence charge density. These cube files encompassing the QM system store the information for QM/MM simulations in DFT-CES (DFT-CES2 with charge density).</p><h3>Preparation for the Pauli Repulsion (DFT-CES2 only)</h3><p>A gaussian convoluted density will be used to interpret the Pauli repulsion interaction across the interface between QM and MM subsystems where the non-bond interaction is dominant. We placed commands for the gaussian blurring after checking some requirements during the QM/MM iteration, you need to make sure that the libraries are installed properly to call the convolution function.</p><h3>Preparation for the Run</h3><p>When you have all systems, and cube files intensionally modified, generally you can run the DFT-CES with the provided executable bash script, but you can do manually.</p><p>An executable for the same job but works with only one handy input will be soon released.</p><h2>Run</h2><pre><code class=language-bash>./qmmm.sh -c or --configuration
./qmmm.sh 
</code></pre><h2>Analysis</h2><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a href=https://mdesignlab.github.io/docs/first-step/installation/><div class="card my-1"><div class="card-body py-2">&larr; Installation</div></div></a><a class=ms-auto href=https://mdesignlab.github.io/docs/example/heterogeneous/><div class="card my-1"><div class="card-body py-2">Slab System &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-xs-12 center-block text-center"><ul class=list-inline><li class=list-inline-item>Copyright © 2023. M-design Lab. All right reserved.</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://mdesignlab.github.io/js/bootstrap.min.650aeec64c81d69d4c0850fc73c93da3f0330cec0a27772feed7f90f60baa5f47f1c45687d71914bdafd1c4e860d40f6dc08ede27a2f08431ff929c9a2d24621.js integrity="sha512-ZQruxkyB1p1MCFD8c8k9o/AzDOwKJ3cv7tf5D2C6pfR/HEVofXGRS9r9HE6GDUD23Ajt4novCEMf+SnJotJGIQ==" crossorigin=anonymous defer></script>
<script src=https://mdesignlab.github.io/js/highlight.min.3f0a703c54cbed82ca277187e23cf2d272da28c15ce7e33cde685d40b53d741893d5b74d35bb2d20a81f56c289084f245bdd0c9145d39d7094d3dfbc62d1326a.js integrity="sha512-PwpwPFTL7YLKJ3GH4jzy0nLaKMFc5+M83mhdQLU9dBiT1bdNNbstIKgfVsKJCE8kW90MkUXTnXCU09+8YtEyag==" crossorigin=anonymous defer></script>
<script src=https://mdesignlab.github.io/js/vendor/katex/dist/katex.min.4a130545cfa0b145956b188947be680113c0368d83dc6e8957d7cb99b4aa95f507169eb70a45b618628dd68d305da05dc4dee3958464b33c112ec1047e4ec2c2.js integrity="sha512-ShMFRc+gsUWVaxiJR75oARPANo2D3G6JV9fLmbSqlfUHFp63CkW2GGKN1o0wXaBdxN7jlYRkszwRLsEEfk7Cwg==" crossorigin=anonymous defer></script>
<script src=https://mdesignlab.github.io/js/vendor/katex/dist/contrib/auto-render.min.f128dc24877a8ff5cdc694570f6cd25f8ad512d4330c242487c4cbbc5dc6fd2c52de778da1e59f98585d1defd5aa5aa583da59e90e6837973ecca3b45b01fb64.js integrity="sha512-8SjcJId6j/XNxpRXD2zSX4rVEtQzDCQkh8TLvF3G/SxS3neNoeWfmFhdHe/Vqlqlg9pZ6Q5oN5c+zKO0WwH7ZA==" crossorigin=anonymous defer></script>
<script src=https://mdesignlab.github.io/main.min.8251b5e87f1566bc6fa219a2ce7ae46ea59ea070850b563f387584f9f8168de79360c3dcfcf41787018400034f08bb89a1ac5f8a79e45bbe193a874a70cae3ea.js integrity="sha512-glG16H8VZrxvohmiznrkbqWeoHCFC1Y/OHWE+fgWjeeTYMPc/PQXhwGEAANPCLuJoaxfinnkW74ZOodKcMrj6g==" crossorigin=anonymous defer></script>
<script src=https://mdesignlab.github.io/index.min.d5565b93c4cdb82eca56fbfdf5d7379568990c0d7781784abaef2eefa3f88c2c245a7c719635899356f3eed30b0e4727abd2be05f8d6ce4761601302aef66688.js integrity="sha512-1VZbk8TNuC7KVvv99dc3lWiZDA13gXhKuu8u76P4jCwkWnxxljWJk1bz7tMLDkcnq9K+BfjWzkdhYBMCrvZmiA==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>